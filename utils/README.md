# Utils

This folder contains utility scripts. , it has the `generate_wallets.sh` script, which generates Ethereum wallets and optionally appends them to our `genesis.json`.

### 1. `generate_wallets.sh`

#### Overview

- **Generates one or more Ethereum wallets** (address + private key).
- **Optionally** appends the addresses to the `alloc` section of a `genesis.json` file if the `-a` flag is used.
- **Outputs** the wallet addresses and private keys to `wallets.txt`.

#### Dependencies

- **[Foundry](https://book.getfoundry.sh/)** (for the `cast` command)
- **openssl** (for generating random private keys)
- **jq** (for manipulating JSON when appending to `genesis.json`)

Make sure all these tools are installed and available on your `PATH`.

#### Usage

```bash
./generate_wallets.sh <number_of_wallets> [-a]
```

- `<number_of_wallets>`: The number of wallets you want to generate. Must be a positive integer.
- `-a` (optional): If present, the script will attempt to append the new wallet addresses to a `genesis.json` file located at `../docker-compose/reth/network-configs/genesis.json`.

#### Examples

1. **Generate 3 wallets without updating `genesis.json`:**

   ```bash
   ./generate_wallets.sh 3
   ```
   This will create:
   - `wallets.txt` containing addresses & private keys.
   - A helpful snippet you can manually copy-paste into `alloc` if needed.

2. **Generate 2 wallets and auto-append them to `genesis.json`:**

   ```bash
   ./generate_wallets.sh 2 -a
   ```
   - In addition to creating `wallets.txt`, the script will look for `../docker-compose/reth/network-configs/genesis.json`.
   - If found, it backs up the existing file, then appends the newly generated addresses under `.alloc`.
   - **Requires** `jq`. If `jq` is missing, the script will skip the append step.

#### Output

1. **Terminal**:
   - Each walletâ€™s address and private key is printed.
   - A JSON snippet for manual insertion into `alloc` if needed.

2. **`wallets.txt`**:
   - Stores all generated addresses and private keys.

3. **`genesis.json`** (if `-a` is used):
   - A backup `genesis_backup_<timestamp>.json` is created.
   - The new addresses are merged into the `.alloc` section.

#### Security Note

All private keys generated by this script are stored in **plain text** and should be used **for development purposes only**.  
Do **not** use these keys on mainnet or in any production environment.

### 2. `gcp_setup.sh`

#### Overview

This script sets up the necessary tools and dependencies for running cloud infrastructure on Google Cloud Platform (GCP).

#### Actions Performed

- Installs essential system packages.
- Installs Docker and configures the user for Docker access.
- Installs Rust, Foundry, Bun, Node.js (via NVM), PNPM, and TypeScript.
- Installs PostgreSQL and configures it with a database (`postman_db`).
- Clones T1 protocol repositories (`t1`, `postman`, `tdex`).

#### Usage

```bash
./gcp_setup.sh
```

#### Output

- Logs installation progress and any issues encountered.
- Ensures Docker, PostgreSQL, Rust, and essential blockchain development tools are installed.

---

### 3. `gcp/github-app-credential-helper`

#### Overview

This script configures GitHub authentication via Workload Identity Federation on GCP.

#### Actions Performed

- Retrieves a GitHub App private key from Google Cloud Secret Manager.
- Generates a JWT using the private key.
- Requests an installation token from GitHub.
- Configures Git to use the generated token for authentication.

#### Dependencies

- `gcloud`
- `jq`
- `curl`
- `jwt` Python module

#### Usage

This script is automatically set up by `gcp_setup.sh` and should not require manual execution unless troubleshooting authentication.

---

### 4. `gcp/setup.sh`

#### Overview

This script ensures that all required dependencies for blockchain development and cloud infrastructure are installed.

#### Actions Performed

- Updates package lists and installs system dependencies.
- Installs Docker, PostgreSQL, Rust, Foundry, Bun, and Node.js.
- Configures PostgreSQL on port `5433`.
- Installs `pnpm`, `jq`, `ts-node`, `hardhat`, and `typescript`.
- Clones required repositories for T1 protocol development.

#### Usage

This script is automatically set up by `gcp_setup.sh` and should not require manual execution unless troubleshooting authentication.

#### Output

- Ensures all required tools are installed and configured.
- Clones necessary repositories for development.

---

## Summary

| Script | Description |
|--------|-------------|
| `generate_wallets.sh` | Generates Ethereum wallets and appends them to `genesis.json` (if specified). |
| `gcp_setup.sh` | Installs blockchain development tools and cloud dependencies. |
| `gcp/github-app-credential-helper` | Configures GitHub authentication via GCP Workload Identity Federation. |
| `gcp/setup.sh` | Installs system dependencies, blockchain tools, and sets up repositories. |
